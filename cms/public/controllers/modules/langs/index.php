<?php# МОДУЛЬ ЯЗЫКИ СИСТЕМЫ v.2.0# Coded by ShadoW (с) 2013class cnt_Index extends Controller{	# ИНИЦИАЛИЗАЦИЯ	public function init()	{		# Проверка авторизации		if (!Core::$_data['authed']) Helpers::redirect(_CMS_.'auth');	}	# СПИСОК ЯЗЫКОВ	public function act_index()	{		# Проверка прав доступа		if (Core::$_data['module_access'] != 'rw') View::assign('readonly', true);		$languages = array();		if ($languages_list = Model::$_db->select('md_languages', "ORDER BY `id` ASC"))		{			foreach($languages_list as $k=>$l)			{				$languages[$k]					= $l;				$languages[$k]['set']			= $l['set'] == 1	? 'star_set' : 'star_unset';				$languages[$k]['set_text']		= $l['set'] == 1	? 'Язык по умолчанию' : 'Сделать языком по умолчанию';				$languages[$k]['status'] 		= $l['active'] == 1	? 'on' : 'off';				$languages[$k]['status_text']	= $l['active'] == 1	? 'Отключить' : 'Включить';			}			unset($languages_list, $k, $l);		}		# ВЫВОД		View::assign('%page_title', 'Список языков');		View::render('modules/langs/list', true, array('languages'=>$languages));	}	# ДОБАВИТЬ ЯЗЫК	public function act_add()	{		# Название страницы		View::assign('%page_title', 'Добавление языка');		# Проверка прав доступа		if (Core::$_data['module_access'] != 'rw') exit(View::render('access_denied'));		# ВЫВОД		View::render('modules/langs/add');	}	# РЕДАКТИРОВАТЬ ЯЗЫК	public function act_edit()	{		if (isset($this->_params[0]) && ($lang_id = filter_var($this->_params[0], FILTER_VALIDATE_INT)) && ($lang = Model::$_db->select('md_languages', "WHERE `id`='$lang_id' LIMIT 1", "`id`, `name`, `code`")))		{			# Название страницы			View::assign('%page_title', 'Редактирование язык');			# Проверка прав доступа			if (Core::$_data['module_access'] != 'rw') exit(View::render('access_denied'));			# ВЫВОД			View::render('modules/langs/edit', true, array('lang'=>$lang));		}		else Helpers::redirect(_MODULES_.'langs/');	}}