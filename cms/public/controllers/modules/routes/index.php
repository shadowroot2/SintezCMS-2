<?php# МОДУЛЬ ЧПУ-МАРШРУТЫ v.2.0# Coded by ShadoW (с) 2013class cnt_Index extends Controller{	# ИНИЦИАЛИЗАЦИ	public function init()	{		# Проверка авторизации		if (!Core::$_data['authed']) Helpers::redirect(_CMS_.'auth');	}	# СПИСОК МАРШРУТОВ	public function act_index()	{		# Проверка прав		if (Core::$_data['module_access'] != 'rw') View::assign('readonly', true);		$routes = array();		if ($routes_list = Model::$_db->select('md_routes', "ORDER BY `sort` ASC"))		{			foreach($routes_list as $k=>$r)			{				$routes[$k]					= $r;				$routes[$k]['status']		= $r['active'] == 1 ? 'on' : 'off';				$routes[$k]['status_text']	= $r['active'] == 1 ? 'Отключить' : 'Включить';			}			unset($routes_list, $k, $r);		}		# ВЫВОД		View::assign('%page_title', 'Список ЧПУ маршрутов');		View::render('modules/routes/list', true, array('routes'=>$routes));	}	# ДОБАВИТЬ МАРШРУТ	public function act_add()	{		# Название страницы		View::assign('%page_title', 'Добавление нового ЧПУ маршрута');		# Проверка прав доступа		if (Core::$_data['module_access'] != 'rw') exit(View::render('access_denied'));		# ВЫВОД		View::render('modules/routes/add');	}	# РЕДАКТИРОВАТЬ МАРШРУТ	public function act_edit()	{		if (isset($this->_params[0]) && ($route_id = filter_var($this->_params[0], FILTER_VALIDATE_INT)) && ($route = Model::$_db->select('md_routes', "WHERE `id`='$route_id' LIMIT 1")))		{			View::assign('%page_title', 'Редактирование ЧПУ маршрута');			# Проверка прав доступа			if (Core::$_data['module_access'] != 'rw') exit(View::render('access_denied'));			# ВЫВОД			View::render('modules/routes/edit', true, array('route'=>$route));		}		else Helpers::redirect(_MODULES_.'routes/');	}}