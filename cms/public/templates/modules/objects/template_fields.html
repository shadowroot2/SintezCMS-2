<script type="text/javascript">// DOM$(function(){	// HTML-редактор	$('#object_template_{$template.id} textarea.htmledit').ckeditor();	// Календари	$('#object_template_{$template.id} .datepick').datepicker();	// Цвета	$('#object_template_{$template.id} .colorpick').jPicker();});</script><div id="object_template_{$template.id}">	{foreach ($template.fields as $f)}	<div class="formfield">		{switch ($f.type)}			{case 'text'}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" type="text" name="fields[{$f.id}]" value="{$f.value}" maxlength="255" />			{break}			{case 'integer'}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" style="width:85px" type="text" name="fields[{$f.id}]" value="{$f.value}" maxlength="10" onkeyup="digInput(this)" />			{break}			{case 'textarea'}				<div class="formtitle">{$f.name}:</div>				<textarea id="field_{$f.id}" name="fields[{$f.id}]" style="height:120px">{$f.value}</textarea>			{break}			{case 'html'}				{!(isset($f.value) ? stripslashes($f.value) : '')}				<div class="formtitle">{$f.name}:</div>				<textarea id="field_{$f.id}" class="htmledit" name="fields[{$f.id}]" style="height:400px">{$f.value}</textarea>			{break}			{case 'date'}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" class="datepick" style="width:77px" name="fields[{$f.id}]" type="text" value="{?((isset($f.value) && ($f.value != '') && ($f.value != '1970-01-01')) ? date('d.m.Y', strtotime($f.value)) : '')}" maxlength="10" readonly="readonly" />			{break}			{case 'time'}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" type="text" name="fields[{$f.id}]" value="{if (isset($f.value))}{$f.value}{else}00:00:00{/if}" maxlength="8" />			{break}			{case 'datetime'}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" class="datepick" type="text" name="fields[{$f.id}]" value="{$f.value}" maxlength="20" readonly="readonly" />			{break}			{case 'checkbox'}				<div class="formtitle">					<input id="field_{$f.id}" name="fields[{$f.id}]" value="1" type="checkbox"{if (isset($f.value) && ($f.value == 1))} checked="checked"{/if} /> {$f.name}				</div>			{break}			{case 'radio'}				<div class="formtitle">{$f.name}:</div>				{foreach (explode("\n", $f.atribute) as $v)}					<label>						<input type="radio" name="fields[{$f.id}]" value="{?$v}"{if (isset($f.value) && ($f.value == $v))} checked="checked"{/if} /> {?$v}					</label>&nbsp;				{/foreach}			{break}			{case 'select'}				<div class="formtitle">{$f.name}:</div>				<select id="field_{$f.id}" style="width:350px" name="fields[{$f.id}]">					{foreach (explode("\n", $f.atribute) as $v)}						<option value="{?$v}"{if (isset($f.value) && ($f.value == $v))} selected="selected"{/if}>{?$v}</option>					{/foreach}				</select>			{break}			{case 'multi-select'}				<div class="formtitle">{$f.name}:</div>				<select name="fields[{$f.id}][]" style="width:350px; height:148px;" multiple="multiple">					{!((isset($f.value) && $f.value != '') ? $f.value = explode("\n", $f.value) : '')}					{foreach (explode("\n", $f.atribute) as $v)}						<option value="{?$v}"{if (isset($f.value) && is_array($f.value) && in_array($v, $f.value))} selected="selected"{/if}>{?$v}</option>					{/foreach}				</select>			{break}			{case 'link'}				<div class="formtitle">{$f.name}:</div>				{if ($link = Model::getObjects($f.atribute))}					<select id="field_{$f.id}" name="fields[{$f.id}]">						{foreach ($link as $o)}							<option value="{$o.id}"{if (isset($f.value) && ($f.value == $o.id))} selected="selected"{/if}>{$o.name}</option>						{/foreach}					</select> <a href="/cms/modules/objects/s/{$f.atribute}" title="Список" target="_blank"><img src="/cms/images/list.png" /></a>				{else}				<span class="error">Связь не найдена</span>				{/if}			{break}			{case 'multi-link'}				<div class="formtitle">{$f.name}:</div>				{if ($link = Model::getObjects($f.atribute))}					{!(isset($f.value) ? $f.value = explode("\n", $f.value) : '')}					<select id="field_{$f.id}" name="fields[{$f.id}][]" style="width:350px;height:148px;" multiple="multiple">						{foreach ($link as $o)}							<option value="{$o.id}"{if (isset($f.value) && in_array($o.id, $f.value))} selected="selected"{/if}>{$o.name}</option>						{/foreach}					</select> <a href="/cms/modules/objects/s/{$f.atribute}" title="Список" target="_blank"><img src="/cms/images/list.png" /></a>				{else}				<span class="error">Связь не найдена</span>				{/if}			{break}			{case 'color'}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" class="colorpick" type="hidden" name="fields[{$f.id}]" value="{$f.value}" readonly="readonly">			{break}			{case 'password'}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" type="text" name="fields[{$f.id}]" value="{?((isset($f.value) && ($f.value != '')) ? '********' : '')}" maxlength="30" />			{break}			{case 'image'}				<div class="formtitle">{$f.name}:</div>				{if (isset($f.value) && ($f.value != ''))}					<div class="file_field" data-field_id="{$f.id}">						{if (isset($frontend))}						<a href="{?_UPLOADS_}{$f.value}" class="fancy" title="Прикрепленное изображение" target="_blank">							<img src="{?_CMS_}image/s/w/250/{$f.value}" />						</a>						{else}							<img src="{?_CMS_}image/s/w/250/{$f.value}" />						{/if}						<table>							<tr height="30">								<td width="20"><img src="{?_CMS_}images/image.png" title="Изображение" /></td>								<td><a href="{?_UPLOADS_}{$f.value}" title="Скачать файл">{$f.value}</a></td>								<td width="20" align="center">									<a class="remove_attach" href="#" title="Удалить изображение">										<img src="{?_CMS_}images/del.png" style="display:block;" />									</a>								</td>							</tr>						</table>					</div>				{/if}				<input id="field_{$f.id}" type="file" name="field_{$f.id}" />			{break}			{case 'audio'}				<div class="formtitle">{$f.name}:</div>				{if (isset($f.value) && ($f.value != ''))}				<div class="file_field" data-field_id="{$f.id}">					<object type="application/x-shockwave-flash" data="{?_TPL_}swf/mp3.swf" height="30" width="450">						<param name="movie" value="{?_TPL_}swf/mp3.swf" />						<param name="allowFullScreen" value="false" />						<param name="wmode" VALUE="transparent" />						<param name="allowScriptAccess" value="always" />						<param name="FlashVars" value="soundFile={?_UPLOADS_}{$f.value}&transparentpagebg=yes&bg=EEEEEE&text=413F42&loader=01ADEC" />						<audio src="{?_UPLOADS_}{$f.value}" preload="auto" controls></audio>					</object>					<table>						<tr height="30">							<td width="20"><img src="{?_CMS_}images/audio.png" title="Аудиофайл" /></td>							<td><a href="{?_UPLOADS_}{$f.value}" title="Скачать файл">{$f.value}</a></td>							<td width="20" align="center">								<a class="remove_attach" href="#" title="Удалить аудиофайл">									<img src="{?_CMS_}images/del.png" style="display:block;" />								</a>							</td>						</tr>					</table>				</div>				{/if}				<input id="field_{$f.id}" name="field_{$f.id}" type="file" />			{break}			{case 'video'}				<div class="formtitle">{$f.name}:</div>				{if (isset($f.value) && ($f.value != ''))}				<div class="file_field" data-field_id="{$f.id}">					{!$movie = _UPLOADS_.$f.value}					<object type="application/x-shockwave-flash" data="{?_TPL_}swf/flowplayer-3.2.7.swf" width="550" height="360" bgcolor="#000000">						<param value="true" name="allowfullscreen">						<param value="always" name="allowscriptaccess">						<param value="high" name="quality">						<param value="false" name="cachebusting">						<param value="#000000" name="bgcolor">						<param value="config={&quot;playerId&quot;:&quot;player&quot;,&quot;clip&quot;:{&quot;url&quot;:&quot;{?$movie}&quot;,&quot;autoPlay&quot;:false,&quot;autoBuffering&quot;:false},&quot;playlist&quot;:[{&quot;url&quot;:&quot;{?$movie}&quot;}]}" name="flashvars">						<video src="{?$movie}" width="550" height="360" poster="{?_CMS_}images/video_holder.png" preload="auto" controls></video>					</object>					<table>						<tr height="30">							<td width="20"><img src="{?_CMS_}images/video.png" title="Видеофайл" /></td>							<td><a href="{?_UPLOADS_}{$f.value}" title="Скачать файл">{$f.value}</a></td>							<td width="20" align="center">								<a class="remove_attach" href="#" title="Удалить видеофайл">									<img src="{?_CMS_}images/del.png" style="display:block;" />								</a>							</td>						</tr>					</table>				</div>				{/if}				<input id="field_{$f.id}" type="file" name="field_{$f.id}" />			{break}			{case 'file'}				<div class="formtitle">{$f.name}:</div>				{if (isset($f.value) && ($f.value != '') && ($parts = explode('.', $f.value)) && ($ext = $parts[sizeof($parts)-1]))}				<div class="file_field" data-field_id="{$f.id}">					<table>						<tr>							<td width="35"><img src="{?_CMS_}images/ext/{if (file_exists(_ABS_CMS_.'images/ext/'.$ext.'.png'))}{$ext}{else}file{/if}.png" title="{$ext}" /></td>							<td><a href="{?_UPLOADS_}{$f.value}" title="Скачать файл">{$f.value}</a></td>							<td width="20" align="center">								<a class="remove_attach" href="#" title="Удалить файл">									<img src="{?_CMS_}images/del.png" style="display:block;" />								</a>							</td>						</tr>					</table>				</div>				{/if}				<input id="field_{$f.id}" type="file" name="field_{$f.id}" />			{break}			{case 'template'}				<div class="formtitle">{$f.name}:</div>				{if ($add_templates = Model::getClasses(false, true))}				<select class="add_template_select" id="field_{$f.id}" style="width:350px" name="fields[{$f.id}]">					<option value="">Выберите шаблон...</option>					{foreach ($add_templates as $at)}					<option value="{$at.id}"{if (isset($f.value) && ($f.value == $at.id))} selected="selected"{/if}>{$at.name}</option>					{/foreach}				</select>				<div class="add_template_fields"{if (isset($f.template))} style="display:block;"{/if}>					{$f.template}				</div>				{else}				<span class="error">Дополнительные шаблоны не найдены</span>				{/if}			{break}			{case 'gmap-coords'}				{if (!isset(Core::$_data['gmaps_loaded']))}{!Core::$_data['gmaps_loaded']=true}<script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=false&callback=gMapsLoaded"></script>{/if}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" class="google_map_field" type="text" name="fields[{$f.id}]" value="{$f.value}" maxlength="50" />			{break}			{case 'ymap-coords'}				{if (!isset(Core::$_data['ymaps_loaded']))}{!Core::$_data['ymaps_loaded']=true}<script type="text/javascript" src="http://api-maps.yandex.ru/2.1-dev/?lang=ru-RU&load=package.full&mode=release&onload=yMapsLoaded"></script>{/if}				<div class="formtitle">{$f.name}:</div>				<input id="field_{$f.id}" class="yandex_map_field" type="text" name="fields[{$f.id}]" value="{$f.value}" maxlength="50" />			{break}			{default}				<div class="formtitle">{$f.name} ({$f.type}):</div>				<input id="field_{$f.id}" name="fields[{$f.id}]" type="text" value="{$f.value}" maxlength="255" />			{break}		{/switch}	</div>	{/foreach}</div>